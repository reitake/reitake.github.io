<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="AoeMgN9r3ZTJhZZgqjfb4tkZf3qRjujP-1gjzMb-x80">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"reitake.github.io","root":"/","scheme":"Pisces","version":"7.7.2","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="R语言基础の笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="R语言基础の笔记">
<meta property="og:url" content="https://reitake.github.io/2019/04/01/R-Notes/index.html">
<meta property="og:site_name" content="My Notes Blog">
<meta property="og:description" content="R语言基础の笔记">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-04-01T11:52:11.000Z">
<meta property="article:modified_time" content="2020-12-07T13:34:33.069Z">
<meta property="article:author" content="rtk">
<meta property="article:tag" content="Note">
<meta property="article:tag" content="R语言">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://reitake.github.io/2019/04/01/R-Notes/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>R语言基础の笔记 | My Notes Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">My Notes Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">生活不易 喵声叹气</h1>
      
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tools">

    <a href="/tools/" rel="section"><i class="fa fa-fw fa-gears"></i>工具</a>

  </li>
        <li class="menu-item menu-item-others">

    <a href="/others/" rel="section"><i class="fa fa-fw fa-spinner"></i>不务正业</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://reitake.github.io/2019/04/01/R-Notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="rtk">
      <meta itemprop="description" content="冷萃少冰不加糖">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="My Notes Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          R语言基础の笔记
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-04-01 19:52:11" itemprop="dateCreated datePublished" datetime="2019-04-01T19:52:11+08:00">2019-04-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-07 21:34:33" itemprop="dateModified" datetime="2020-12-07T21:34:33+08:00">2020-12-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E3%80%8C%E8%AF%AD%E8%A8%80%E3%80%8D/" itemprop="url" rel="index"><span itemprop="name">「语言」</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/04/01/R-Notes/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/04/01/R-Notes/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <center> <font color="#bababa">

<p><strong><em>R语言基础の笔记</em></strong></p>
<p></font></center></p>
<a id="more"></a>

<hr>
<h1 id="R-语言基础"><a href="#R-语言基础" class="headerlink" title="R 语言基础"></a>R 语言基础</h1><h2 id="1-一维数据结构-概念介绍"><a href="#1-一维数据结构-概念介绍" class="headerlink" title="1.一维数据结构-概念介绍"></a>1.一维数据结构-概念介绍</h2><ul>
<li>数据类型  <ul>
<li>character：字符型</li>
<li>numeric：数值型，指实数或小数</li>
<li>integer：整型</li>
<li>complex：复数型</li>
<li>logical：逻辑型</li>
</ul>
</li>
<li>数据结构<ul>
<li>向量（对应数值变量）、因子（对应分类变量）</li>
<li>矩阵（内部数据类型一致）、数据框（内部每个向量内数据类型一致）</li>
<li>数组（三维、更高维）、列表（可包含不同结构类型元素）</li>
</ul>
</li>
<li>向量<ul>
<li>c()</li>
<li>冒号操作符:</li>
<li>seq(from, to, by, lenth.out, along.with)<br>·提取子集</li>
<li>数字下标（正数、负数）</li>
<li>which()函数</li>
</ul>
</li>
<li>因子<ul>
<li>factor()</li>
<li>gl()</li>
</ul>
</li>
</ul>
<h2 id="2-一维数据结构-代码演示"><a href="#2-一维数据结构-代码演示" class="headerlink" title="2.一维数据结构-代码演示"></a>2.一维数据结构-代码演示</h2><ul>
<li>等号=跟&lt;-是一样的赋值操作符</li>
<li>(x=c(10,11,13,14))，最外的括号表示立即输出</li>
<li>Ctrl+Enter为单行执行</li>
<li>因子的水平（level）在R语言内部用数字表示</li>
<li>一维数据结构</li>
</ul>
<h2 id="3-二位数据结构——矩阵"><a href="#3-二位数据结构——矩阵" class="headerlink" title="3.二位数据结构——矩阵"></a>3.二位数据结构——矩阵</h2><ul>
<li>行和列</li>
<li>生成矩阵<ul>
<li>matrix()</li>
<li>由向量派生</li>
<li>由向量组合生成</li>
</ul>
</li>
<li>操作<ul>
<li>访问元素</li>
<li>行、列命名</li>
</ul>
</li>
<li>矩阵运算：向量运算按照矩阵运算统一<ul>
<li>加减运算</li>
<li>乘法运算：数乘、对应元素相乘、矩阵乘法</li>
<li>单位矩阵、对角矩阵</li>
<li>矩阵转置</li>
<li>矩阵的特征值和特征向量</li>
<li>矩阵的逆</li>
<li>求解线性方程组</li>
</ul>
</li>
</ul>
<h2 id="4-二位数据结构——数据框"><a href="#4-二位数据结构——数据框" class="headerlink" title="4.二位数据结构——数据框"></a>4.二位数据结构——数据框</h2><ul>
<li>记录和域</li>
<li>创建数据框 data.frame()</li>
<li>操作：</li>
<li>访问元素 $、[[]]</li>
<li>attach、detach</li>
<li>with、within</li>
<li>subset</li>
</ul>
<h2 id="5-高维数据结构——列表和数组"><a href="#5-高维数据结构——列表和数组" class="headerlink" title="5.高维数据结构——列表和数组"></a>5.高维数据结构——列表和数组</h2><ul>
<li>列表中：成分</li>
<li>创建列表：list()</li>
<li>操作：</li>
<li>列表成分names</li>
<li>[]、[[]]</li>
<li>数组：不同于其他语言的数组，是矩阵的延伸</li>
</ul>
<h2 id="6-数据类型转换"><a href="#6-数据类型转换" class="headerlink" title="6.数据类型转换"></a>6.数据类型转换</h2><ul>
<li>类型转换<ul>
<li>安全级别：字符&gt;数字&gt;布尔（更安全）</li>
<li>is.character、as.character…</li>
</ul>
</li>
<li>数据结构<ul>
<li>is.mastrix、as.mastrix…</li>
</ul>
</li>
</ul>
<h2 id="7-分支结构"><a href="#7-分支结构" class="headerlink" title="7.分支结构"></a>7.分支结构</h2><ul>
<li>if … else …结构<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(condition)&#123;</span><br><span class="line">    <span class="keyword">...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>ifelse()函数，支持向量化计算<br><code>ifelse(b,u,v)</code>  </li>
</ul>
<h2 id="8-循环结构"><a href="#8-循环结构" class="headerlink" title="8.循环结构"></a>8.循环结构</h2><ul>
<li>for(n in x){…} （x是向量）</li>
<li>while(codition){…}</li>
<li>repeat{… break}</li>
<li>break、next</li>
</ul>
<h2 id="9-函数和包：代码重用"><a href="#9-函数和包：代码重用" class="headerlink" title="9.函数和包：代码重用"></a>9.函数和包：代码重用</h2><ul>
<li>自定义函数：(一类对象，可以随时创建）<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">myfun=<span class="keyword">function</span>(par1,par2..)&#123;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>查看函数代码<ul>
<li>不带括号的函数名</li>
<li>page</li>
</ul>
</li>
<li>source函数加载文件（保存成.r文件）  </li>
</ul>
<p><code>source(&#39;E:/rTEST/06.function.r&#39;)</code></p>
<h2 id="10-向量化运算和apply家族"><a href="#10-向量化运算和apply家族" class="headerlink" title="10.向量化运算和apply家族"></a>10.向量化运算和apply家族</h2><ul>
<li>向量化运算<ul>
<li>+-*/四则运算</li>
<li>&lt;!=逻辑运算</li>
</ul>
</li>
<li>apply家族<ul>
<li>apply</li>
<li>sapply、lapply</li>
<li>mapply、tapply</li>
</ul>
</li>
</ul>
<hr>
<h1 id="建立对数据的感性认识"><a href="#建立对数据的感性认识" class="headerlink" title="建立对数据的感性认识"></a>建立对数据的感性认识</h1><h2 id="1-变量类型"><a href="#1-变量类型" class="headerlink" title="1.变量类型"></a>1.变量类型</h2><ul>
<li>连续变量（数值变量）</li>
<li>离散变量（名义变量、分类变量）</li>
</ul>
<h2 id="2-数据分布"><a href="#2-数据分布" class="headerlink" title="2.数据分布"></a>2.数据分布</h2><ul>
<li>分布就是概率</li>
<li>分布函数<ul>
<li>概率密度函数（PDF）</li>
<li>累计密度函数（CDF）</li>
<li><h2 id="3-连续变量的典型分布"><a href="#3-连续变量的典型分布" class="headerlink" title="3.连续变量的典型分布"></a>3.连续变量的典型分布</h2></li>
</ul>
</li>
<li>正态分布</li>
<li>中心极限定理</li>
<li>经验法则</li>
<li>切比雪夫定理</li>
</ul>
<h2 id="4-离散变量的典型分布"><a href="#4-离散变量的典型分布" class="headerlink" title="4.离散变量的典型分布"></a>4.离散变量的典型分布</h2><ul>
<li>0-1分布</li>
<li>二项分布</li>
<li>泊松分布（n很大，p很小时对二项分布的近似）</li>
</ul>
<h2 id="5-单变量的集中趋势描述"><a href="#5-单变量的集中趋势描述" class="headerlink" title="5.单变量的集中趋势描述"></a>5.单变量的集中趋势描述</h2><ul>
<li>集中趋势：一组数据向着一个中心靠拢的程度，也体现了数据中心点所在位置。</li>
<li>分类变量<ul>
<li>众数</li>
</ul>
</li>
<li>连续变量<ul>
<li>均值（算数平均数、几何平均数、加权平均数）</li>
<li>中位数</li>
<li>分位数</li>
</ul>
</li>
<li>被滥用的均值<ul>
<li>非单峰分布</li>
<li>极值的影响</li>
<li>简单的算术平均</li>
</ul>
</li>
</ul>
<h2 id="6-单变量的离散程度描述"><a href="#6-单变量的离散程度描述" class="headerlink" title="6.单变量的离散程度描述"></a>6.单变量的离散程度描述</h2><ul>
<li>离散程度：一组数据远离其中心的程度。<ul>
<li>集中趋势从数据中选“典型代表”，“代表是否够典型”由离散程度检验。</li>
</ul>
</li>
<li>离散统计量<ul>
<li>极差</li>
<li>方差、标准差</li>
<li>Z分数</li>
<li>变异系数</li>
</ul>
</li>
<li>偏度（Skewness）描述某变量取值分不对称性。<ul>
<li>对称（=0）</li>
<li>左偏（&lt;0）均值落于中位数左侧，极小值多</li>
<li>右偏（&gt;0）均值落于中位数右侧，极大值多</li>
</ul>
</li>
<li>峰度（Kurtosis）描述某变量所有取值分布形态陡缓程度。<ul>
<li>正态分布（0、3）</li>
<li>尖顶峰（&gt;0、3）</li>
<li>平定峰（&lt;0、3）</li>
</ul>
</li>
</ul>
<h2 id="7-双变量的统计描述"><a href="#7-双变量的统计描述" class="headerlink" title="7.双变量的统计描述"></a>7.双变量的统计描述</h2><ul>
<li>相关性：两个变量共同变化的趋势。（是否有线性关系，相关不代表因果，正/负不代表相关性强弱）<ul>
<li>正相关、负相关、线性无关</li>
<li>协方差 Cov(X,Y)=E[(X-E[X])(Y-E[Y])]=E[XY]-2E[Y]E[X]+E[X]E[Y]=E[XY]-E[X]E[Y]</li>
<li>相关系数 ρXY=Cov(X,Y)/(D(X)^0.5*D(Y)^0.5)  （-1~1之间）</li>
<li>协方差矩阵（对角线都是1，对称矩阵）</li>
</ul>
</li>
</ul>
<h2 id="8-产生符合特定分布的测试数据"><a href="#8-产生符合特定分布的测试数据" class="headerlink" title="8.产生符合特定分布的测试数据"></a>8.产生符合特定分布的测试数据</h2><ul>
<li>分布函数家族：*func()</li>
</ul>
<p>*：<br>    + r：随机分布函数<br>    + d：概率密度函数<br>    + p：累积分布函数<br>    + q：分位数函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.生成符合特定分布的数据</span></span><br><span class="line"><span class="comment">#   二项分布</span></span><br><span class="line"><span class="comment">#   x~(N,P)  N=100, P=0.7</span></span><br><span class="line">str(rbinom)</span><br><span class="line"></span><br><span class="line"><span class="comment">#   生成随机数</span></span><br><span class="line">x=rbinom(<span class="number">5</span>,<span class="number">1</span>,<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line">x=rbinom(<span class="number">5</span>,<span class="number">100000</span>,<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#   得到概率</span></span><br><span class="line">y=dbinom(<span class="number">20</span>,<span class="number">100</span>,<span class="number">0.7</span>) <span class="comment">#100次实验中正好共发生20次的概率</span></span><br><span class="line">y=dbinom(<span class="number">60</span>:<span class="number">90</span>,<span class="number">100</span>,<span class="number">0.7</span>)</span><br><span class="line">sum(y)</span><br><span class="line"></span><br><span class="line">y=dbinom(<span class="number">0</span>:<span class="number">100</span>,<span class="number">100</span>,<span class="number">0.7</span>)</span><br><span class="line">plot(<span class="number">0</span>:<span class="number">100</span>,y,pch=<span class="number">16</span>) <span class="comment">#概率密度曲线</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   得到累积概率</span></span><br><span class="line">y=pbinom(<span class="number">20</span>,<span class="number">100</span>,<span class="number">0.7</span>) <span class="comment">#100次实验中发生小于20次的概率</span></span><br><span class="line"></span><br><span class="line">pbinom(<span class="number">40</span>,<span class="number">100</span>,<span class="number">0.7</span>)-pbinom(<span class="number">20</span>,<span class="number">100</span>,<span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#   累积函数密度曲线</span></span><br><span class="line">plot(<span class="number">0</span>:<span class="number">100</span>,pbinom(<span class="number">0</span>:<span class="number">100</span>,<span class="number">100</span>,<span class="number">0.7</span>),pch=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#   得到分位数</span></span><br><span class="line">x=pbinom(<span class="number">0.4</span>,<span class="number">100</span>,<span class="number">0.7</span>)</span><br></pre></td></tr></table></figure>

<h2 id="9-R的单变量统计函数"><a href="#9-R的单变量统计函数" class="headerlink" title="9.R的单变量统计函数"></a>9.R的单变量统计函数</h2><ul>
<li>均值：mean</li>
<li>中位数：median</li>
<li>分位数：quantile</li>
<li>方差：var</li>
<li>标准差：sd</li>
<li>频数表：table</li>
<li>峰度</li>
<li>偏度<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2.单变量的描述统计</span></span><br><span class="line">str(airquality)</span><br><span class="line">summary(airquality)</span><br><span class="line"></span><br><span class="line">mean(airquality$Ozone,na.rm=<span class="literal">T</span>) <span class="comment">#变量中有NA（缺失值)时删除NA</span></span><br><span class="line">median(airquality$Ozone,na.rm=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">mean(airquality$Temp,na.rm=<span class="literal">T</span>,trim=<span class="number">.01</span>) <span class="comment">#trim是按百分比裁剪极值</span></span><br><span class="line"></span><br><span class="line">temp100=rnorm(<span class="number">100</span>,<span class="number">30</span>,<span class="number">1</span>)</span><br><span class="line">w=<span class="number">1</span>:<span class="number">100</span></span><br><span class="line">(wtm=(weighted.mean(temp100,w,na.rm=<span class="literal">T</span>))) <span class="comment">#加权平均数</span></span><br><span class="line"></span><br><span class="line">x=c(<span class="number">.045</span>,<span class="number">.021</span>,<span class="number">.225</span>,<span class="number">.018</span>)</span><br><span class="line">(xm=mean(x))</span><br><span class="line">(xg=exp(mean(log(x)))) <span class="comment">#几何平均数</span></span><br><span class="line"></span><br><span class="line">(tmid=median(temp100,na.rm=<span class="literal">T</span>)) <span class="comment">#中位数</span></span><br><span class="line"></span><br><span class="line">quantile(airquality$Temp,na.rm=<span class="literal">T</span>) <span class="comment">#分位数</span></span><br><span class="line">quantile(airquality$Temp,probs=c(<span class="number">0</span>,<span class="number">0.1</span>,<span class="number">0.9</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">(tv=var(temp100)) <span class="comment">#方差</span></span><br><span class="line">(ts=sd(temp100)) <span class="comment">#标准差</span></span><br><span class="line"></span><br><span class="line">fivenum(temp100)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自定义偏度、峰度计算函数</span></span><br><span class="line">apply(airquality[,c(-<span class="number">5</span>,-<span class="number">6</span>)],<span class="number">2</span>,FUN=mean,na.rm=<span class="literal">T</span>)</span><br><span class="line">sapply(airquality[,c(-<span class="number">5</span>,-<span class="number">6</span>)],FUN=mean,na.rm=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">mysummary=<span class="keyword">function</span>(x,<span class="keyword">...</span>)&#123;</span><br><span class="line">  Av=mean(x,na.rm=<span class="literal">T</span>)</span><br><span class="line">  Sd=sd(x,na.rm=<span class="literal">T</span>)</span><br><span class="line">  N=length(x[!is.na(x)])</span><br><span class="line">  Sk=sum((x[!is.na(x)]-Av)^<span class="number">3</span>/Sd^<span class="number">3</span>)/N</span><br><span class="line">  Ku=sum((x[!is.na(x)]-Av)^<span class="number">3</span>/Sd^<span class="number">4</span>)/N-<span class="number">3</span></span><br><span class="line">  </span><br><span class="line">  result=c(avg=Av,sd=Sd,skew=Sk,kurt=Ku)</span><br><span class="line">  <span class="keyword">return</span>(result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sapply(airquality[,c(-<span class="number">5</span>,-<span class="number">6</span>)],FUN=mysummary,na.rm=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 非单峰分布不能简单计算均值</span></span><br><span class="line">x=rnorm(<span class="number">100</span>,<span class="number">50</span>,<span class="number">6</span>)</span><br><span class="line">y=rnorm(<span class="number">200</span>,<span class="number">150</span>,<span class="number">8</span>)</span><br><span class="line">z=c(x,y)</span><br><span class="line">plot(density(z))</span><br><span class="line">abline(v=mean(z),col=<span class="number">3</span>,lw=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="10-R的双变量相关函数"><a href="#10-R的双变量相关函数" class="headerlink" title="10.R的双变量相关函数"></a>10.R的双变量相关函数</h2><ul>
<li>协方差：cov</li>
<li>相关系数：cor</li>
<li>确实值处理：行删除、配对删除<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3.双变量的相关性</span></span><br><span class="line">cov(airquality[,-<span class="number">5</span>:-<span class="number">6</span>],use=<span class="string">'pairwise.complete.obs'</span>) <span class="comment">#配对删除</span></span><br><span class="line">cov(airquality[,-<span class="number">5</span>:-<span class="number">6</span>],use=<span class="string">'complete.obs'</span>) <span class="comment">#行删除</span></span><br><span class="line"></span><br><span class="line">cor(airquality[,-<span class="number">5</span>:-<span class="number">6</span>],use=<span class="string">'pairwise.complete.obs'</span>) <span class="comment">#配对删除</span></span><br><span class="line">cor(airquality[,-<span class="number">5</span>:-<span class="number">6</span>],use=<span class="string">'complete.obs'</span>) <span class="comment">#行删除</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="11-统计量的可视化"><a href="#11-统计量的可视化" class="headerlink" title="11.统计量的可视化"></a>11.统计量的可视化</h2><ul>
<li>散点图</li>
<li>盒线图</li>
<li>直方图</li>
<li>核密度图</li>
<li>柱状图、条形图</li>
<li>饼图</li>
<li>点图</li>
<li>散点图集<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 散点图</span></span><br><span class="line">plot(airquality$Ozone)</span><br><span class="line">plot(airquality$Ozone,airquality$Wind)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 箱线图</span></span><br><span class="line">boxplot(airquality$Temp)</span><br><span class="line">boxplot(airquality$Temp,horizontal = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直方图</span></span><br><span class="line">hist(airquality$Temp)</span><br><span class="line">hist(airquality$Temp,breaks=<span class="number">30</span>) <span class="comment">#横轴块数</span></span><br><span class="line">hist(airquality$Temp,prob=<span class="literal">T</span>) <span class="comment">#纵轴从频数变成频率</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 密度</span></span><br><span class="line">plot(density(airquality$Temp))</span><br><span class="line"></span><br><span class="line">hist(airquality$Temp,prob=<span class="literal">T</span>)</span><br><span class="line">lines(density(airquality$Temp),col=<span class="number">3</span>,lw=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 柱状图</span></span><br><span class="line">barplot(table(airquality$Month))</span><br><span class="line">barplot(table(airquality$Month),horiz = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 饼图</span></span><br><span class="line">pie(table(airquality$Month))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 图集</span></span><br><span class="line">plot(airquality[,<span class="number">1</span>:<span class="number">4</span>])</span><br><span class="line">pairs(airquality[,<span class="number">1</span>:<span class="number">4</span>])</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="数据的组织和整理——输入和输出"><a href="#数据的组织和整理——输入和输出" class="headerlink" title="数据的组织和整理——输入和输出"></a>数据的组织和整理——输入和输出</h1><h2 id="1-基本输入输出"><a href="#1-基本输入输出" class="headerlink" title="1.基本输入输出"></a>1.基本输入输出</h2><ul>
<li>输入<br>  1）readline<br>  2）edit、fix</li>
<li>输出<br>  1）print<br>  2）cat</li>
<li>输出重定向<br>  1）sink<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本输入输出</span></span><br><span class="line"><span class="comment">#   输入</span></span><br><span class="line">x=readline(<span class="string">'你好：'</span>)</span><br><span class="line">x</span><br><span class="line"></span><br><span class="line">mydata=data.frame(name=character(<span class="number">0</span>),age=numeric(<span class="number">0</span>),height=numeric(<span class="number">0</span>))</span><br><span class="line">mydata=edit(mydata) <span class="comment">#注意要用=把临时变量赋回来</span></span><br><span class="line">mydata</span><br><span class="line"></span><br><span class="line">fix(mydata)</span><br><span class="line">mydata</span><br><span class="line"></span><br><span class="line"><span class="comment">#   输出</span></span><br><span class="line">x=rnorm(<span class="number">10</span>,<span class="number">100</span>,<span class="number">2</span>)</span><br><span class="line">print(x) <span class="comment">#输出有编号，末尾自带换行符</span></span><br><span class="line">cat(x) <span class="comment">#更紧凑，无编号，可以打印到文件中</span></span><br><span class="line">print(x,digits=<span class="number">4</span>) <span class="comment">#输出格式</span></span><br><span class="line">print(<span class="string">'helloword 1'</span>);print(<span class="string">'welcome to R'</span>)</span><br><span class="line">cat(<span class="string">'hello world 1'</span>);cat(<span class="string">'welcome to R'</span>) <span class="comment">#输出末尾无换行符</span></span><br><span class="line">cat(format(x,digits=<span class="number">3</span>),<span class="string">'\n'</span>) <span class="comment">#输出格式，换行符</span></span><br><span class="line"></span><br><span class="line">cat(<span class="string">'hello world'</span>,file=<span class="string">'d:/app.log'</span>)</span><br><span class="line"></span><br><span class="line">sink(<span class="string">'d:/output.txt'</span>) <span class="comment">#执行后，之后的print、cat输出都会被重新向到文件中</span></span><br><span class="line">print(<span class="string">'hello'</span>)</span><br><span class="line">cat(<span class="string">'sdfjksdf'</span>,<span class="string">'\n'</span>)</span><br><span class="line">sink()</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="2-模拟数据和自带数据集"><a href="#2-模拟数据和自带数据集" class="headerlink" title="2.模拟数据和自带数据集"></a>2.模拟数据和自带数据集</h2><ul>
<li>模拟数据</li>
<li>自带数据集<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 任意分布</span></span><br><span class="line"><span class="comment"># y=a*x+b+e</span></span><br><span class="line"><span class="comment"># x~N(0,2)</span></span><br><span class="line"><span class="comment"># e~N(0,1)</span></span><br><span class="line"><span class="comment"># b=0.5, a=2</span></span><br><span class="line"></span><br><span class="line">set.seed(<span class="number">10</span>) <span class="comment"># 随机种子，用来产生相同的随机数</span></span><br><span class="line">x=rnorm(<span class="number">100</span>,<span class="number">0</span>,<span class="number">2</span>)</span><br><span class="line">e=rnorm(<span class="number">100</span>)</span><br><span class="line">y=<span class="number">2</span>*x+<span class="number">0.5</span>+e</span><br><span class="line">plot(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机数</span></span><br><span class="line">(x=rbinom(<span class="number">5</span>,<span class="number">100</span>,<span class="number">0.7</span>))</span><br><span class="line">(x=rbinom(<span class="number">5</span>,<span class="number">100</span>,<span class="number">0.7</span>))</span><br><span class="line"></span><br><span class="line">set.seed(<span class="number">10</span>)</span><br><span class="line">(x=rbinom(<span class="number">5</span>,<span class="number">100</span>,<span class="number">0.7</span>))</span><br><span class="line">(x=rbinom(<span class="number">5</span>,<span class="number">100</span>,<span class="number">0.7</span>))</span><br><span class="line">set.seed(<span class="number">10</span>)</span><br><span class="line">(x=rbinom(<span class="number">5</span>,<span class="number">100</span>,<span class="number">0.7</span>))</span><br><span class="line">(x=rbinom(<span class="number">5</span>,<span class="number">100</span>,<span class="number">0.7</span>)) <span class="comment"># 跟上面相同</span></span><br><span class="line"></span><br><span class="line">data(package=<span class="string">'datasets'</span>)</span><br><span class="line">data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看系统所有包中的数据集</span></span><br><span class="line">data(package=.packages(all.available = <span class="literal">T</span>))</span><br><span class="line"><span class="keyword">library</span>(arules)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="3-文件数据源"><a href="#3-文件数据源" class="headerlink" title="3.文件数据源"></a>3.文件数据源</h2><ul>
<li>文本文件：read.table read.csv read.delim</li>
<li>Excel文件：四种方法</li>
<li>SPSS文件：foreign::read.spss、Hmisc::spss.get<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件数据源</span></span><br><span class="line">getwd() <span class="comment">#查看当前工作目录</span></span><br><span class="line">setwd(<span class="string">'d:/'</span>) <span class="comment">#更改当前工作目录</span></span><br><span class="line">x=rnorm(<span class="number">1000</span>,<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">y=rnorm(<span class="number">1000</span>,<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">z=rnorm(<span class="number">1000</span>,<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">save(x,y,z,file=<span class="string">'xyz.Rdata'</span>)</span><br><span class="line">l=load(<span class="string">'xyz.Rdata'</span>)</span><br><span class="line">l <span class="comment"># l=变量名字列表</span></span><br><span class="line"></span><br><span class="line">x=read.table(<span class="string">'xyz.Rdata'</span>,header=<span class="literal">F</span>,seq=<span class="string">''</span>,comment.char=<span class="string">'@'</span>)</span><br><span class="line">x</span><br><span class="line">str(x)</span><br><span class="line">x=read.csv(<span class="string">'scan0.txt'</span>,header=<span class="literal">F</span>,seq=<span class="string">''</span>)</span><br><span class="line">x=read.delim(<span class="string">'scan0.txt'</span>,header=<span class="literal">F</span>) <span class="comment">#这几个red都一样，只是参数缺省值不同</span></span><br><span class="line">x=read.delim(<span class="string">'clipborad'</span>,header=<span class="literal">F</span>) <span class="comment">#从剪切板读</span></span><br><span class="line"></span><br><span class="line">write.table(x,<span class="string">'d:/scan2.txt'</span>,seq=<span class="string">','</span>,quote=<span class="literal">F</span>,col.names=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Excel文件</span></span><br><span class="line"><span class="comment">#   1.csv文件</span></span><br><span class="line"><span class="comment">#   2.剪切板+read.delim</span></span><br><span class="line"><span class="comment">#   3.xlsx扩展包</span></span><br><span class="line"><span class="comment">#   4.rodbc数据源</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">library</span>(foreign) <span class="comment">#这个包提供了read.spss方法</span></span><br><span class="line">cars=read.spss(<span class="string">'d:/car_sales.sav'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">library</span>(Hmisc) <span class="comment">#简单方法，需要额外装这个包</span></span><br><span class="line">cust=spss.get(<span class="string">'d:/car_sales.csv'</span>,use.value.labels=<span class="literal">T</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="4-关系型数据库（MySQL）"><a href="#4-关系型数据库（MySQL）" class="headerlink" title="4.关系型数据库（MySQL）"></a>4.关系型数据库（MySQL）</h2><ul>
<li>ODBC方式（开放数据库连接（Open Database Connectivity）定义了访问数据库API的一个规范）</li>
<li>RMySQL方式<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#RMySQL</span></span><br><span class="line">install.packages(<span class="string">'RMySQL'</span>)</span><br><span class="line"><span class="keyword">library</span>(RMySQL)</span><br><span class="line">conn = dbConnect(MySQL(),dbname=<span class="string">'rtest'</span>,username=<span class="string">'rtest'</span>,password=<span class="string">'rtest'</span>,host=<span class="string">"192.168.1.100"</span>,port=<span class="number">3306</span>)</span><br><span class="line"></span><br><span class="line">dbListTables(conn)</span><br><span class="line">dbListFields(conn,<span class="string">'t_user'</span>)</span><br><span class="line">summary(MySQL(),verbose=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">users=dbReadTable(conn,<span class="string">'t_user'</span>)</span><br><span class="line">str(users)</span><br><span class="line">users</span><br><span class="line"></span><br><span class="line">tmpUser=data.frame( name=paste(<span class="string">'user'</span>,<span class="number">1</span>:<span class="number">100</span>,sep=<span class="string">''</span>),</span><br><span class="line">                   age=rnorm(<span class="number">100</span>,<span class="number">50</span>,<span class="number">5</span>))</span><br><span class="line">tmpUser</span><br><span class="line">dbWriteTable(conn,<span class="string">'t_user'</span>,tmpUser,append=<span class="literal">T</span>,row.names=<span class="literal">FALSE</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dbWriteTable(conn,<span class="string">'t_stu'</span>,tmpUser,append=<span class="literal">T</span>)</span><br><span class="line">dbReadTable(conn,<span class="string">'t_stu'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res=dbGetQuery(conn,<span class="string">'select * from t_user where age&gt;10'</span>)</span><br><span class="line">res</span><br><span class="line"></span><br><span class="line">res=dbSendQuery(conn,<span class="string">'show databases'</span>) </span><br><span class="line">dl=fetch(res)  </span><br><span class="line">dl</span><br><span class="line"></span><br><span class="line">dbDisconnect(conn) <span class="comment"># 断开连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#RODBC    mysqlodbc驱动要装，system32文件下odbcad32.exe</span></span><br><span class="line">install.packages(<span class="string">'RODBC'</span>)</span><br><span class="line"><span class="keyword">library</span>(RODBC)</span><br><span class="line">conn=odbcConnect(<span class="string">"mysqlodbc"</span>)</span><br><span class="line">conn=odbcConnect(<span class="string">"mysqlodbc"</span>, uid=<span class="string">"rtest"</span>, pwd=<span class="string">'rtest'</span>)</span><br><span class="line">sqlTables(conn)</span><br><span class="line">users=sqlFetch(conn,<span class="string">'t_user'</span>)</span><br><span class="line">users</span><br><span class="line">str(users)</span><br><span class="line"></span><br><span class="line">users=sqlQuery(conn,<span class="string">'select * from t_user where age&gt;15'</span>)</span><br><span class="line">users</span><br><span class="line"> </span><br><span class="line">odbcClose(conn)</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h1 id="数据的组织和整理——数据预处理（1）"><a href="#数据的组织和整理——数据预处理（1）" class="headerlink" title="数据的组织和整理——数据预处理（1）"></a>数据的组织和整理——数据预处理（1）</h1><h2 id="1-日期时间、字符串的处理"><a href="#1-日期时间、字符串的处理" class="headerlink" title="1.日期时间、字符串的处理"></a>1.日期时间、字符串的处理</h2><p>·日期和时间<br>    - Date：日期类<br>    - POSIXct：日期时间类，精确到秒。内部用数字表示</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 得到当前日期时间</span></span><br><span class="line">(di=Sys.Date())</span><br><span class="line">(d2=date())</span><br><span class="line"></span><br><span class="line">myDate=as.Date(<span class="string">'2007-08-09'</span>)</span><br><span class="line">class(myDate)</span><br><span class="line">mode(myDate)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 日期转字符串</span></span><br><span class="line">as.character(myDate)</span><br><span class="line"></span><br><span class="line">dirDay=c(<span class="string">'01/05/1986'</span>,<span class="string">'08/11/1976'</span>)</span><br><span class="line">dates=as.Date(dirDay,<span class="string">'%m/%d/%Y'</span>)</span><br><span class="line">dates</span><br><span class="line"></span><br><span class="line">td=Sys.Date()</span><br><span class="line">format(td,format=<span class="string">'%B  %d %Y'</span>)</span><br><span class="line">format(td,format=<span class="string">'%A,%a'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 日期转换成个数字</span></span><br><span class="line">as.integer(Sys.Date())</span><br><span class="line">as.integer(as.Date(<span class="string">'1970-1-1'</span>))</span><br><span class="line">as.integer(as.Date(<span class="string">'1970-1-2'</span>))</span><br><span class="line"></span><br><span class="line">sdate=as.Date(<span class="string">'1904-1-1'</span>)</span><br><span class="line">edate=as.Date(<span class="string">'2010-11-1'</span>)</span><br><span class="line">days=edate-sdate</span><br><span class="line">days</span><br><span class="line"></span><br><span class="line">ws=difftime(Sys.Date(),as.Date(<span class="string">'1956-10-12'</span>),units=<span class="string">'weeks'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 把年月日拼成日期</span></span><br><span class="line">(d=ISOdate(<span class="number">2011</span>,<span class="number">10</span>,<span class="number">2</span>));class(d) <span class="comment"># ISOdate()可以拼成日期，类型是POSIXct</span></span><br><span class="line">as.Date(ISOdate(<span class="number">2011</span>,<span class="number">10</span>,<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">ISOdate(<span class="number">2011</span>,<span class="number">2</span>,<span class="number">30</span>) <span class="comment">#不存在的日期返回NA</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量转换成日期</span></span><br><span class="line">years=c(<span class="number">2010</span>,<span class="number">2011</span>,<span class="number">2012</span>,<span class="number">2013</span>,<span class="number">2014</span>,<span class="number">2015</span>)</span><br><span class="line">months=<span class="number">1</span></span><br><span class="line">days=c(<span class="number">15</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">19</span>,<span class="number">30</span>,<span class="number">3</span>)</span><br><span class="line">as.Date(ISOdate(years,months,days)) <span class="comment"># ISOdate()支持向量化运算</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取日期时间的一部分</span></span><br><span class="line">p=as.POSIXlt(Sys.Date())</span><br><span class="line">Sys.Date()</span><br><span class="line">p$year+<span class="number">1900</span> <span class="comment"># 年要+1900</span></span><br><span class="line">p$mon+<span class="number">1</span> <span class="comment"># 月要+1</span></span><br><span class="line">p$mday</span><br><span class="line">p$hour</span><br><span class="line">p$min</span><br><span class="line">p$sec</span><br></pre></td></tr></table></figure>

<ul>
<li>字符串<ul>
<li>nchar(),length()</li>
<li>paste(),outer()</li>
<li>substr(),strsplit()</li>
<li>Sub(),gsub(),grep(),regexpr(),grepexpr()</li>
<li>POSIXlt：日期时间类，精确到秒。内部用列表表示</li>
<li>Sys.date(),date(),difftime(),ISOdate(),ISOdatetime()</li>
</ul>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="string">'hello\rwld\n'</span></span><br><span class="line">cat(x) <span class="comment"># 会执行转义字符</span></span><br><span class="line">print(x) <span class="comment"># 不执行，都输出显示</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串长度</span></span><br><span class="line">nchar(x)</span><br><span class="line">length(x) <span class="comment"># 得到向量个数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符串拼接</span></span><br><span class="line">board=paste(<span class="string">'b'</span>,<span class="number">1</span>:<span class="number">4</span>,seq=<span class="string">'-'</span>)</span><br><span class="line">board</span><br><span class="line"></span><br><span class="line">mm=paste(<span class="string">'mm'</span>,<span class="number">1</span>:<span class="number">3</span>,seq=<span class="string">'-'</span>)</span><br><span class="line">mm</span><br><span class="line"></span><br><span class="line">outer(board,mm,paste,seq=<span class="string">':'</span>) <span class="comment"># outer向量配对</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拆分提取</span></span><br><span class="line">board</span><br><span class="line">substr(board,<span class="number">3</span>,<span class="number">3</span>) <span class="comment"># 第3个开始，第3个结束</span></span><br><span class="line">strsplit(board,<span class="string">'-'</span>,fixed=<span class="literal">T</span>) <span class="comment"># fixed抑制正则表达式</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改</span></span><br><span class="line">sub(<span class="string">'-'</span>,<span class="string">'.'</span>,board,fixed=<span class="literal">T</span>) <span class="comment"># 只是修改了临时对象</span></span><br><span class="line">board</span><br><span class="line">mm</span><br><span class="line">sub(<span class="string">'m'</span>,<span class="string">'p'</span>,mm) <span class="comment"># sub替换第一个匹配项</span></span><br><span class="line">gsub(<span class="string">'m'</span>,<span class="string">'p'</span>,mm) <span class="comment"># gsub替换全部匹配项</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找</span></span><br><span class="line">mm=c(mm,<span class="string">'mm4'</span>)</span><br><span class="line">mm</span><br><span class="line">grep(<span class="string">'-'</span>,mm) <span class="comment"># 返回第几个元素包含'-'</span></span><br><span class="line">regexpr(<span class="string">'-'</span>,mm) <span class="comment"># 返返回位置信息</span></span><br></pre></td></tr></table></figure>

<h2 id="2-数据预处理概念"><a href="#2-数据预处理概念" class="headerlink" title="2.数据预处理概念"></a>2.数据预处理概念</h2><ul>
<li>数据预处理的意义<br>·数据质量<ul>
<li>准确性，完整性，一致性，冗余性，时效性……</li>
</ul>
</li>
<li>数据预处理的内容<ul>
<li>数据集成，数据转换，数据清洗，数据简约</li>
<li>数据清洗时又脏又累的活</li>
</ul>
</li>
</ul>
<h2 id="3-数据集成"><a href="#3-数据集成" class="headerlink" title="3.数据集成"></a>3.数据集成</h2><ul>
<li>merge #数据框合成</li>
<li>pylr::join # 包名::函数<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(customer=data.frame(Id=c(<span class="number">1</span>:<span class="number">6</span>),State=c(rep(<span class="string">"北京"</span>,<span class="number">3</span>),rep(<span class="string">"上海"</span>,<span class="number">3</span>))))</span><br><span class="line">(ol=data.frame(Id=c(<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>),Product=c(<span class="string">'IPhone'</span>,<span class="string">'Vixo'</span>,<span class="string">'mi'</span>,<span class="string">'Note2'</span>)))</span><br><span class="line"></span><br><span class="line">merge(customer,ol,by=(<span class="string">'Id'</span>)) <span class="comment"># inner join</span></span><br><span class="line">merge(customer,ol,by=(<span class="string">'Id'</span>),all=<span class="literal">T</span>) <span class="comment"># full jion 全连接</span></span><br><span class="line">merge(customer,ol,by=(<span class="string">'Id'</span>),all.x=<span class="literal">T</span>) <span class="comment"># left outer jion 左连接</span></span><br><span class="line">merge(customer,ol,by=(<span class="string">'Id'</span>),all.y=<span class="literal">T</span>) <span class="comment"># right outer jion 右连接</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># union 去重 在df1和df2有相同的列名称下</span></span><br><span class="line">rbind(df1,df2) <span class="comment"># 不去重合并</span></span><br><span class="line"></span><br><span class="line">merge(df1,df2,all=<span class="literal">T</span>) <span class="comment"># 去重合并</span></span><br><span class="line">merge(df1,df2,by=(<span class="string">'id'</span>)) <span class="comment"># 显示id相同的行</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="4-数据转换"><a href="#4-数据转换" class="headerlink" title="4.数据转换"></a>4.数据转换</h2><ul>
<li>构造属性</li>
<li>规范化（极差化、标准化）</li>
<li>离散化</li>
<li>改善分布<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">str(airquality)</span><br><span class="line">head(airquality,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 排序</span></span><br><span class="line">airquality=airquality[order(airquality$Temp),]</span><br><span class="line"></span><br><span class="line">head(airquality,<span class="number">5</span>)</span><br><span class="line">tail(airquality,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造属性</span></span><br><span class="line">quantile(airquality$Temp,probs=c(<span class="number">0</span>,<span class="number">0.3</span>,<span class="number">0.6</span>,<span class="number">1.0</span>))</span><br><span class="line">airquality$isHot=ifelse(airquality$Temp&gt;<span class="number">80</span>,<span class="literal">T</span>,<span class="literal">F</span>)</span><br><span class="line">airquality=within(airquality,&#123;TempL=<span class="literal">NA</span></span><br><span class="line">TempL[Temp&gt;<span class="number">80</span>]=<span class="string">'Hot'</span></span><br><span class="line">TempL[Temp&gt;<span class="number">70</span>&amp;Temp&lt;=<span class="number">80</span>]=<span class="string">'Warm'</span></span><br><span class="line">TempL[Temp&lt;=<span class="number">70</span>]=<span class="string">'Cold'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">airquality$TempL</span><br><span class="line"></span><br><span class="line">airquality$TempL=factor(airquality$TempL,levels=c(<span class="string">'Cold'</span>,<span class="string">'Warm'</span>,<span class="string">'Hot'</span>,ordered=<span class="literal">TRUE</span>))</span><br><span class="line">unclass(airquality$TempL)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据规范化</span></span><br><span class="line">tmp=data.frame(TC=scale(airquality$Temp,scale=<span class="literal">F</span>),</span><br><span class="line">               TZ=scale(airquality$Temp))</span><br><span class="line">tmp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连续变量变离散变量</span></span><br><span class="line">airquality=within(airquality,&#123;</span><br><span class="line">  TempL1=cut(Temp,breaks=c(<span class="number">56</span>,<span class="number">73</span>,<span class="number">81</span>,<span class="number">97</span>),include.lowest = <span class="literal">T</span>)</span><br><span class="line">&#125;)</span><br><span class="line">head(airquality,<span class="number">5</span>)</span><br><span class="line">airquality$TempL1</span><br><span class="line"></span><br><span class="line">airquality=within(airquality,&#123;</span><br><span class="line">  TempL1=cut(Temp,breaks=quantile(Temp,probs=c(<span class="number">0</span>,<span class="number">0.3</span>,<span class="number">0.7</span>,<span class="number">1</span>)),include.lowest = <span class="literal">T</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">table(airquality$TempL1)</span><br><span class="line">prop.table(table(airquality$TempL1))</span><br><span class="line"></span><br><span class="line"><span class="keyword">library</span>(Hmisc)</span><br><span class="line">airquality=within(airquality,&#123;</span><br><span class="line">  TempL3=cut2(Temp,g=<span class="number">4</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="数据的组织和整理——数据预处理（2）"><a href="#数据的组织和整理——数据预处理（2）" class="headerlink" title="数据的组织和整理——数据预处理（2）"></a>数据的组织和整理——数据预处理（2）</h1><h2 id="1-发现缺失值"><a href="#1-发现缺失值" class="headerlink" title="1.发现缺失值"></a>1.发现缺失值</h2><ul>
<li>缺失值的表达方式：NA（没有数字）、NaN（无效的数字，如1/0）、Inf（正无穷）、-Inf（负无穷）</li>
<li>发现缺省值：summary(),is.na(),complete.case()</li>
<li>缺失值是否有业务含义</li>
<li>把不合理数据编码为确实值<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 没有意识到“缺失值问题”的时候就得到的答案</span></span><br><span class="line"><span class="keyword">library</span>(VIM)</span><br><span class="line"></span><br><span class="line">sleep.lm=lm(Dream~Sl)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发现缺失值</span></span><br><span class="line"><span class="comment">#   1.属性级别</span></span><br><span class="line">is.na(sleep$Sleep) <span class="comment"># 返回的是向量，可用于提取</span></span><br><span class="line"></span><br><span class="line">sleep$Sleep[is.na(sleep$Sleep)]</span><br><span class="line">sleep$Sleep[!(is.na(sleep$Sleep))]</span><br><span class="line"></span><br><span class="line">mean(is.na(sleep$Sleep)) <span class="comment">#缺失值比例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#   2.记录级别</span></span><br><span class="line">complete.cases(sleep) <span class="comment">#在记录级别来识别</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据集拆分</span></span><br><span class="line">sleep.cleaned=sleep[complete.cases(sleep),] <span class="comment">#拆分出没有缺失值的数据</span></span><br><span class="line"><span class="comment">#sleep.cleaned=na.omit(sleep)</span></span><br><span class="line">sleep.cleaned=sleep[complete.cases(sleep),] <span class="comment">#拆分出有缺失值的数据</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="2-缺失值模式"><a href="#2-缺失值模式" class="headerlink" title="2.缺失值模式"></a>2.缺失值模式</h2><ul>
<li>完全随机缺失 Missing Completely At Random, MCAR（缺失跟其他变量、跟自己都没关系）</li>
<li>随机缺失 Missing At Random, MAR （缺失跟其他变量有关系，跟自己没关系）</li>
<li>非随机缺失 NMAR （既跟其他变量有关系，也跟自己有关系）</li>
<li>VIM包</li>
<li>mice包<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#   3.概要信息</span></span><br><span class="line"><span class="keyword">library</span>(mice)</span><br><span class="line">md.pattern(sleep)</span><br><span class="line"></span><br><span class="line">aggr(sleep,number=<span class="literal">T</span>,prop=<span class="literal">F</span>)</span><br><span class="line">matrixplot(sleep)</span><br><span class="line">marginplot(sleep[,c(<span class="string">'Dream'</span>,<span class="string">'Sleep'</span>)])</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="3-删除确实值"><a href="#3-删除确实值" class="headerlink" title="3.删除确实值"></a>3.删除确实值</h2><ul>
<li>分析函数<ul>
<li>na.rm=T （=T计算这条函数时不考虑缺失值，但不是删除，=F包含缺失值）</li>
</ul>
</li>
<li>行删除<ul>
<li>na.omit</li>
</ul>
</li>
<li>配对删除  （多个分析中数据可能来自不同的数据集<ul>
<li>典型函数cor(data.use=”pairwise.complete.obs”)<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">na.omit(sleep) <span class="comment"># 整行删除</span></span><br><span class="line">cor(sleep,use=<span class="string">"pairwise.complete.obs"</span>) <span class="comment"># 配对删除</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="4-填补缺失值"><a href="#4-填补缺失值" class="headerlink" title="4.填补缺失值"></a>4.填补缺失值</h2><ul>
<li>简单抽样填补</li>
<li>均值填补</li>
<li>回归填补<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简单随机抽样填充</span></span><br><span class="line">sub.index=which(is.na(sleep$Sleep)==<span class="literal">T</span>)</span><br><span class="line">sleep.clean=sleep[-sub.index,]</span><br><span class="line">sleep.na=sleep[sub.index,] <span class="comment"># 数据集的拆分</span></span><br><span class="line"></span><br><span class="line">sleep.na$Sleep=sample(sleep.clean$Sleep,</span><br><span class="line">                      nrow(sleep.na),replace = <span class="literal">T</span>) <span class="comment"># 抽样（抽样范围，抽样条数，有放回抽样）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 均值填充</span></span><br><span class="line">sub.index=which(is.na(sleep$Dleep)==<span class="literal">T</span>)</span><br><span class="line">sleep.clean=sleep[-sub.index,]</span><br><span class="line">sleep.na=sleep[sub.index,]</span><br><span class="line"></span><br><span class="line">sleep.na$Dream=mean(sleep.clean$Dream)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回归填充</span></span><br><span class="line">sub.index=which(is.na(sleep$Sleep)==<span class="literal">T</span>)</span><br><span class="line">sleep.clean=sleep[-sub.index,]</span><br><span class="line">sleep.na=sleep[sub.index,]</span><br><span class="line"></span><br><span class="line">sleep.lm=lm(Sleep~Gest+Exp,data=sleep)</span><br><span class="line">sleep.na$Sleep=round(predict(sleep.lm,sleep.na),<span class="number">2</span>) <span class="comment"># round(,2)保留小数点后两位</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用哪两个变量做回归填充预测</span></span><br><span class="line">cor(cleep,use=<span class="string">"pairwise.complete.obs"</span>)</span><br><span class="line"><span class="keyword">library</span>(corrgram)</span><br><span class="line">corrgram(cor(sleep,use=<span class="string">"pairwise.complete.obs"</span>),</span><br><span class="line">         lower.panel.panel.conf,upper.panel=panel.pie) <span class="comment"># 看Sleep这一列，sleep跟哪两个相关性最强</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="数据可视化——基础绘图体系"><a href="#数据可视化——基础绘图体系" class="headerlink" title="数据可视化——基础绘图体系"></a>数据可视化——基础绘图体系</h1><h2 id="1-图形设备"><a href="#1-图形设备" class="headerlink" title="1.图形设备"></a>1.图形设备</h2><ul>
<li>图形设备<ul>
<li>pdf,png,jpeg,bmp</li>
<li>win.metafile,postscript</li>
<li>dev.off</li>
</ul>
</li>
<li>高水平绘图函数<ul>
<li>plot,pairs,hist</li>
</ul>
</li>
<li>低水平绘图函数  （需要依托于高水平函数）<ul>
<li>points,lines,text,abline,legend,title,axis<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">plot.women=<span class="keyword">function</span>()&#123;</span><br><span class="line">  plot(women$height,women$weight,</span><br><span class="line">      main=<span class="string">'height-weight'</span>,</span><br><span class="line">      xlab=<span class="string">'height'</span>,</span><br><span class="line">      ylab=<span class="string">'weight'</span>,</span><br><span class="line">      col=<span class="string">'red'</span>, <span class="comment"># 点颜色</span></span><br><span class="line">      pch=<span class="number">19</span>, <span class="comment"># 点的状态</span></span><br><span class="line">      xlim=c(<span class="number">0</span>,<span class="number">100</span>), <span class="comment">#x坐标范围</span></span><br><span class="line">      ylim=c(<span class="number">100</span>,<span class="number">200</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">plot.line=<span class="keyword">function</span>()&#123;</span><br><span class="line">  lines(women$height,women$weight,col=<span class="string">'blue'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">plot.women()</span><br><span class="line"></span><br><span class="line">pdf(<span class="string">'d:/women.pdf'</span>) <span class="comment"># 图都绘制到pdf设备中了</span></span><br><span class="line">plot.women()</span><br><span class="line">dev.off() <span class="comment"># 及时关闭文件设备</span></span><br><span class="line"></span><br><span class="line">plot.women()</span><br><span class="line">plot.line()</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="2-数值型单变量的可视化（箱线图和直方图）"><a href="#2-数值型单变量的可视化（箱线图和直方图）" class="headerlink" title="2.数值型单变量的可视化（箱线图和直方图）"></a>2.数值型单变量的可视化（箱线图和直方图）</h2><ul>
<li>箱线图<ul>
<li>分组箱线图</li>
</ul>
</li>
<li>直方图<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 箱线图</span></span><br><span class="line">bp.info=boxplot(airquality$Ozone,main=<span class="string">'OZone'</span>,horizontal=<span class="literal">T</span>,axes=<span class="literal">T</span>) <span class="comment">#有返回值，horizontal方向，axes是否显示坐标轴</span></span><br><span class="line"></span><br><span class="line">abline(v=mean(airquality$Ozone,na.rm = <span class="literal">T</span>),col=<span class="string">'red'</span>,lty=<span class="string">'dotted'</span>)</span><br><span class="line"></span><br><span class="line">bp.info</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组箱线图</span></span><br><span class="line">bp.info=boxplot(airquality$Ozone~airquality$Month,main=<span class="string">'OZone'</span>,horizontal=<span class="literal">T</span>,axes=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直方图</span></span><br><span class="line">ht.info=hist(airquality$Ozone,breaks = <span class="number">20</span>,freq = <span class="literal">F</span>) <span class="comment">#breaks=区间数量，freq=纵坐标频数/频率</span></span><br><span class="line"></span><br><span class="line">lines(density(airquality$Ozone,na.rm = <span class="literal">T</span>))</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="3-数值型单变量的可视化（密度图和小提琴图）"><a href="#3-数值型单变量的可视化（密度图和小提琴图）" class="headerlink" title="3.数值型单变量的可视化（密度图和小提琴图）"></a>3.数值型单变量的可视化（密度图和小提琴图）</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">hist(airquality$Ozone,breaks = <span class="number">20</span>,freq = <span class="literal">F</span>) <span class="comment">#breaks=区间数量，freq=纵坐标频数/频率</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 密度图</span></span><br><span class="line">lines(density(airquality$Ozone,na.rm = <span class="literal">T</span>)) <span class="comment">#核密度估计图</span></span><br><span class="line"></span><br><span class="line">omean=mean(airquality$Ozone,na.rm = <span class="literal">T</span>)</span><br><span class="line">osd=sd(airquality$Ozone,na.rm = <span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line">x=seq(from=min(airquality$Ozone,na.rm = <span class="literal">T</span>),</span><br><span class="line">      to=max(airquality$Ozone,na.rm = <span class="literal">T</span>),</span><br><span class="line">      length=<span class="number">1000</span>)</span><br><span class="line">y=dnorm(x,omean,osd)</span><br><span class="line">lines(x,y,col=<span class="string">'red'</span>,lwd=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 小提琴图</span></span><br><span class="line"><span class="keyword">library</span>(vioplot)</span><br><span class="line">help(package=<span class="string">"vioplot"</span>)</span><br><span class="line">&lt;/code&gt;</span><br><span class="line"><span class="number">4.</span>离散型单变量的可视化</span><br><span class="line">·条形图和柱状图</span><br><span class="line">·分组条形图（柱状图）</span><br><span class="line">·堆叠条形图（柱状图）</span><br><span class="line">·饼图</span><br><span class="line">&lt;code&gt;</span><br><span class="line">score=read.csv(<span class="string">'d:/ReprotCard.txt'</span>,header=<span class="literal">T</span>,seq=<span class="string">' '</span>)</span><br><span class="line">score=na.omit(score) <span class="comment"># 干掉确实值</span></span><br><span class="line">nGrade=tapply(score$avScore,score$avScore,length)</span><br><span class="line">nGrade</span><br><span class="line">barplot(nGrade,names=c(<span class="string">'良'</span>,<span class="string">'中'</span>,<span class="string">'及格'</span>,<span class="string">'不及格'</span>),horiz=<span class="literal">F</span>) <span class="comment">#horiz=T条形图，=F柱状图</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分组柱状图</span></span><br><span class="line">nGradeBySex=table(score&amp;sex,score$avScore)</span><br><span class="line">nGradeBySex</span><br><span class="line">barplot(nGradeBySex,beside=<span class="literal">F</span>,col=(<span class="number">1</span>,<span class="number">2</span>),ylim=c(<span class="number">0</span>,<span class="number">20</span>)) <span class="comment">#beside=T分组柱状图，=F堆叠柱状图</span></span><br><span class="line">legend(<span class="string">'topright'</span>,c(<span class="string">'女'</span>,<span class="string">'男'</span>)，pch=c(<span class="number">15</span>,<span class="number">15</span>),col=c(<span class="number">1</span>,<span class="number">2</span>),horiz=<span class="literal">F</span>,cex=<span class="number">0.8</span>) <span class="comment"># 图例</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 饼图</span></span><br><span class="line">score=read.csv(<span class="string">'d:/ReprotCard.txt'</span>,header=<span class="literal">T</span>,seq=<span class="string">' '</span>)</span><br><span class="line">score=na.omit(score)</span><br><span class="line">nGrade=table(score$avScore)</span><br><span class="line">pie(nGrade)</span><br><span class="line">pct=round(nGrade/length(score$avScore)*<span class="number">100</span>,<span class="number">2</span>)</span><br><span class="line">pct</span><br><span class="line">labs=paste(c(<span class="string">'良'</span>,<span class="string">'中'</span>,<span class="string">'及格'</span>,<span class="string">'不及格'</span>),pct,<span class="string">'%'</span>,seq=<span class="string">''</span>)</span><br><span class="line">labs</span><br><span class="line"><span class="keyword">library</span>(RcolorBrewer)</span><br><span class="line">pie(nGrade,labels=labs,main=<span class="string">'各等级比例'</span>，col=brewer.pal(length(nGrade),<span class="string">'Set1'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3D饼图</span></span><br><span class="line"><span class="keyword">library</span>(plotrix)</span><br><span class="line">pie3D(nGrade,labels=labs,main=<span class="string">'各等级比例'</span>，col=brewer.pal(length(nGrade),<span class="string">'Set1'</span>),explode=<span class="number">0.2</span>)</span><br><span class="line">fan.plot(nGrade,labels=labs,main=<span class="string">'各等级比例'</span>，col=brewer.pal(length(nGrade),<span class="string">'Set1'</span>)) <span class="comment"># 扇形图</span></span><br><span class="line"></span><br><span class="line">par(mfrow=c(<span class="number">1</span>,<span class="number">3</span>)) <span class="comment">#窗口画布布局一行三列</span></span><br><span class="line">pie(nGrade,labels=labs,main=<span class="string">'各等级比例'</span>，col=brewer.pal(length(nGrade),<span class="string">'Set1'</span>))</span><br><span class="line">pie3D(nGrade,labels=labs,main=<span class="string">'各等级比例'</span>，col=brewer.pal(length(nGrade),<span class="string">'Set1'</span>),explode=<span class="number">0.2</span>)</span><br><span class="line">fan.plot(nGrade,labels=labs,main=<span class="string">'各等级比例'</span>，col=brewer.pal(length(nGrade),<span class="string">'Set1'</span>)) <span class="comment"># 扇形图</span></span><br></pre></td></tr></table></figure>


<h1 id="数据可视化——多变量关系可视化"><a href="#数据可视化——多变量关系可视化" class="headerlink" title="数据可视化——多变量关系可视化"></a>数据可视化——多变量关系可视化</h1><h2 id="1-双变量的可视化"><a href="#1-双变量的可视化" class="headerlink" title="1.双变量的可视化"></a>1.双变量的可视化</h2><ul>
<li>连续型双变量</li>
<li>连续型变量+离散型变量</li>
<li>离散型变量</li>
<li>散点图<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">x=rnorm(<span class="number">1000</span>)</span><br><span class="line">y=rnorm(<span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line">plot(x,y,cex=<span class="number">1</span>,pch=<span class="number">19</span>,col=<span class="string">'red'</span>,main=<span class="string">'XY散点图'</span>) <span class="comment">#cex点的大小，pch点的形状</span></span><br><span class="line"></span><br><span class="line">x=rbinom(<span class="number">10000</span>)</span><br><span class="line">y=rbinom(<span class="number">10000</span>,<span class="number">10</span>,<span class="number">0.1</span>) </span><br><span class="line">plot(x,y,cex=<span class="number">1</span>,pch=<span class="number">19</span>,col=<span class="string">'red'</span>,main=<span class="string">'XY散点图'</span>) <span class="comment"># 点重叠，丢失密度信息</span></span><br><span class="line"></span><br><span class="line">sunflowerplot(x,y,cex=<span class="number">1</span>,col=<span class="string">'red'</span>,main=<span class="string">'XY散点图'</span>) <span class="comment">#太阳花法</span></span><br><span class="line"></span><br><span class="line">plot(jitter(x),jitter(y),cex=<span class="number">1</span>,col=<span class="string">'red'</span>,main=<span class="string">'XY散点图'</span>) <span class="comment">#加入抖动</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#install.packages('scatterplot3d')</span></span><br><span class="line"><span class="keyword">library</span>(scatterplot3d)</span><br><span class="line">s3d=scatterplot3d(airquality$Temp,airquality$Wind,airquality$Ozone</span><br><span class="line">                  highlight.3d=<span class="literal">TRUE</span>,col.axis=<span class="string">'blue'</span>,</span><br><span class="line">                  col.grid=<span class="string">"lightblue"</span>,angle=<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">attach</span>(airquality)</span><br><span class="line">plot(Wind,Temp)</span><br><span class="line"><span class="comment"># 1.一元线性回归</span></span><br><span class="line">alm=lm(Temp~Wind)</span><br><span class="line">abline(alm$coefficients)</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.局部加权回归</span></span><br><span class="line">alowess=loess(Temp~Wind)</span><br><span class="line"></span><br><span class="line">ord=order(Wind)</span><br><span class="line">lines(Wind[ord],alowess$fitted[ord],lwd=<span class="number">1</span>,col=<span class="number">2</span>)</span><br><span class="line"><span class="keyword">detach</span>(airquality)</span><br></pre></td></tr></table></figure>
<h2 id="2-多变量的可视化"><a href="#2-多变量的可视化" class="headerlink" title="2.多变量的可视化"></a>2.多变量的可视化</h2></li>
<li>矩阵散点图</li>
<li>相关系数图<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 矩阵散点图</span></span><br><span class="line">str(airquality)</span><br><span class="line">pairs(~Ozone+Solar.R+Wind+Temp,data=airquality)</span><br><span class="line">plot(~Ozone+Solar.R+Wind+Temp,data=airquality)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 矩阵散点图中加线</span></span><br><span class="line"><span class="keyword">library</span>(car)</span><br><span class="line">scatterplotMatrix(~Ozone+Solar.R+Wind+Temp,data=airquality,lty.smooth=<span class="number">2</span>,spread=<span class="literal">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#相关系数图</span></span><br><span class="line"><span class="keyword">library</span>(corrgram)</span><br><span class="line">corrgram(airquality[,c(-<span class="number">5</span>,-<span class="number">6</span>)],</span><br><span class="line">         lower.panel=panel.pie,</span><br><span class="line">         upper.panel=panel.conf,</span><br><span class="line">         text.panel=panel.txt)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="3-分组可视化"><a href="#3-分组可视化" class="headerlink" title="3.分组可视化"></a>3.分组可视化</h2><ul>
<li>Lattice绘图体系<ul>
<li>面板和面板函数<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">unique(iris$Species)</span><br><span class="line"></span><br><span class="line">par(mfrow=c(<span class="number">2</span>,<span class="number">2</span>)) <span class="comment">#定义3行1列布局</span></span><br><span class="line"></span><br><span class="line">by(iris,iris$Species,FUN=<span class="keyword">function</span>(data)&#123;</span><br><span class="line">  plot(data$Sepal.Length,data$Sepal.Width,main=unique(data$Species))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Lattice包</span></span><br><span class="line"><span class="keyword">library</span>(lattice)</span><br><span class="line">head(iris,<span class="number">3</span>)</span><br><span class="line">xyplot(Sepal.Length~Sepal.Width,data=iris)</span><br><span class="line"></span><br><span class="line">plot(Sepal.Length~Sepal.Width,data=iris)</span><br><span class="line"></span><br><span class="line">xyplot(Sepal.Length~Sepal.Width,data=iris,groups=Species)</span><br><span class="line"></span><br><span class="line">xyplot(Sepal.Length~Sepal.Width | Species,data=iris) <span class="comment">#分组</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 箱线图</span></span><br><span class="line">bwplot(Sepal.Length~Species,data=iris)</span><br><span class="line">bwplot(~Sepal.Length | Species,data=iris)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直方图</span></span><br><span class="line">histogram(~Sepal.Width | Species,data=iris)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密度图</span></span><br><span class="line">densityplot(~Sepal.Width | Species,data=iris) </span><br><span class="line">densityplot(~Sepal.Width,groups=Species,data=iris) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 带状图</span></span><br><span class="line">stripplot(Species~Sepal.Width,data=iris)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 平行坐标图</span></span><br><span class="line">parallelplot(~iris[<span class="number">1</span>:<span class="number">4</span>] | Species,iris)</span><br><span class="line">parallelplot(~iris[<span class="number">1</span>:<span class="number">4</span>],groups=Species,iris,horizontal.axis = <span class="literal">F</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3D图</span></span><br><span class="line">cloud(Ozone~Wind*Temp|Month,data=airquality)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="4-自定义面板函数实例"><a href="#4-自定义面板函数实例" class="headerlink" title="4.自定义面板函数实例"></a>4.自定义面板函数实例</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">panel.myplot=<span class="keyword">function</span>(x,y)&#123;</span><br><span class="line">  panel.grid(h=-<span class="number">1</span>,y=-<span class="number">1</span>) <span class="comment">#网格</span></span><br><span class="line">  panel.xyplot(x,y,pch=<span class="number">19</span>) <span class="comment">#散点图</span></span><br><span class="line">  panel.loess(x,y,col=<span class="string">'green'</span>,lwd=<span class="number">2</span>,lty=<span class="number">3</span>) <span class="comment">#局部加权回归</span></span><br><span class="line">  paney.lmline(x,y,col=<span class="string">'red'</span>,lwd=<span class="number">2</span>,lty=<span class="number">2</span>) <span class="comment">#线性回归</span></span><br><span class="line">  panel.rug(x,y) <span class="comment">#展示rug</span></span><br><span class="line">  panel.abline(h=mean(y),lwd=<span class="number">1</span>,lty=<span class="number">2</span>,col=<span class="string">'blue'</span>) <span class="comment">#y的均值线</span></span><br><span class="line">  panel.abline(v=mean(x),lwd=<span class="number">1</span>,lty=<span class="number">2</span>,col=<span class="string">'blue'</span>)</span><br><span class="line">&#125;</span><br><span class="line">xyplot(Sepal.Length~Sepal.Width|Species,data=iris,</span><br><span class="line">       panel=panel.myplot,</span><br><span class="line">       layout=c(<span class="number">2</span>,<span class="number">2</span>),aspect=<span class="number">1.5</span>)</span><br><span class="line">ls(<span class="string">'package:lattice'</span>,pattern = <span class="string">'^panel.+'</span>)</span><br></pre></td></tr></table></figure>




<h1 id="假设检验"><a href="#假设检验" class="headerlink" title="假设检验"></a>假设检验</h1><h2 id="1-假设检验概述"><a href="#1-假设检验概述" class="headerlink" title="1.假设检验概述"></a>1.假设检验概述</h2><ul>
<li>什么是假设检验</li>
<li>假设检验的目的</li>
<li>两种误差：系统误差，随机误差</li>
<li>假设检验执行步骤<ul>
<li>简历要检验的假设，确定检验水准</li>
<li>选择并计算适宜的统计量</li>
<li>确定P值，做出推断<h2 id="2-t分布和t检验"><a href="#2-t分布和t检验" class="headerlink" title="2.t分布和t检验"></a>2.t分布和t检验</h2></li>
</ul>
</li>
<li>t分布的特点<ul>
<li>单峰，以0为中心，左右对称</li>
<li>分布形态和样本数量n有关</li>
<li>n -&gt; ∞时，逼近标准正态曲线</li>
<li>t曲线不是一条曲线，而是一簇曲线</li>
</ul>
</li>
<li>t检验是基于t分布的比较平均数的检验方法</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Note/" rel="tag"><i class="fa fa-tag"></i> Note</a>
              <a href="/tags/R%E8%AF%AD%E8%A8%80/" rel="tag"><i class="fa fa-tag"></i> R语言</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/03/27/Hexo-NexT-Config/" rel="prev" title="Hexo + NexT(v7.0.1) 博客配置备忘">
      <i class="fa fa-chevron-left"></i> Hexo + NexT(v7.0.1) 博客配置备忘
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/04/01/SEO-Notes/" rel="next" title="SEO 学习笔记">
      SEO 学习笔记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#R-语言基础"><span class="nav-number">1.</span> <span class="nav-text">R 语言基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-一维数据结构-概念介绍"><span class="nav-number">1.1.</span> <span class="nav-text">1.一维数据结构-概念介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-一维数据结构-代码演示"><span class="nav-number">1.2.</span> <span class="nav-text">2.一维数据结构-代码演示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-二位数据结构——矩阵"><span class="nav-number">1.3.</span> <span class="nav-text">3.二位数据结构——矩阵</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-二位数据结构——数据框"><span class="nav-number">1.4.</span> <span class="nav-text">4.二位数据结构——数据框</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-高维数据结构——列表和数组"><span class="nav-number">1.5.</span> <span class="nav-text">5.高维数据结构——列表和数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-数据类型转换"><span class="nav-number">1.6.</span> <span class="nav-text">6.数据类型转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-分支结构"><span class="nav-number">1.7.</span> <span class="nav-text">7.分支结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-循环结构"><span class="nav-number">1.8.</span> <span class="nav-text">8.循环结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-函数和包：代码重用"><span class="nav-number">1.9.</span> <span class="nav-text">9.函数和包：代码重用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-向量化运算和apply家族"><span class="nav-number">1.10.</span> <span class="nav-text">10.向量化运算和apply家族</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#建立对数据的感性认识"><span class="nav-number">2.</span> <span class="nav-text">建立对数据的感性认识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-变量类型"><span class="nav-number">2.1.</span> <span class="nav-text">1.变量类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-数据分布"><span class="nav-number">2.2.</span> <span class="nav-text">2.数据分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-连续变量的典型分布"><span class="nav-number">2.3.</span> <span class="nav-text">3.连续变量的典型分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-离散变量的典型分布"><span class="nav-number">2.4.</span> <span class="nav-text">4.离散变量的典型分布</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-单变量的集中趋势描述"><span class="nav-number">2.5.</span> <span class="nav-text">5.单变量的集中趋势描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-单变量的离散程度描述"><span class="nav-number">2.6.</span> <span class="nav-text">6.单变量的离散程度描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-双变量的统计描述"><span class="nav-number">2.7.</span> <span class="nav-text">7.双变量的统计描述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-产生符合特定分布的测试数据"><span class="nav-number">2.8.</span> <span class="nav-text">8.产生符合特定分布的测试数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-R的单变量统计函数"><span class="nav-number">2.9.</span> <span class="nav-text">9.R的单变量统计函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-R的双变量相关函数"><span class="nav-number">2.10.</span> <span class="nav-text">10.R的双变量相关函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-统计量的可视化"><span class="nav-number">2.11.</span> <span class="nav-text">11.统计量的可视化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据的组织和整理——输入和输出"><span class="nav-number">3.</span> <span class="nav-text">数据的组织和整理——输入和输出</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-基本输入输出"><span class="nav-number">3.1.</span> <span class="nav-text">1.基本输入输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-模拟数据和自带数据集"><span class="nav-number">3.2.</span> <span class="nav-text">2.模拟数据和自带数据集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-文件数据源"><span class="nav-number">3.3.</span> <span class="nav-text">3.文件数据源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-关系型数据库（MySQL）"><span class="nav-number">3.4.</span> <span class="nav-text">4.关系型数据库（MySQL）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据的组织和整理——数据预处理（1）"><span class="nav-number">4.</span> <span class="nav-text">数据的组织和整理——数据预处理（1）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-日期时间、字符串的处理"><span class="nav-number">4.1.</span> <span class="nav-text">1.日期时间、字符串的处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-数据预处理概念"><span class="nav-number">4.2.</span> <span class="nav-text">2.数据预处理概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-数据集成"><span class="nav-number">4.3.</span> <span class="nav-text">3.数据集成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-数据转换"><span class="nav-number">4.4.</span> <span class="nav-text">4.数据转换</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据的组织和整理——数据预处理（2）"><span class="nav-number">5.</span> <span class="nav-text">数据的组织和整理——数据预处理（2）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-发现缺失值"><span class="nav-number">5.1.</span> <span class="nav-text">1.发现缺失值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-缺失值模式"><span class="nav-number">5.2.</span> <span class="nav-text">2.缺失值模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-删除确实值"><span class="nav-number">5.3.</span> <span class="nav-text">3.删除确实值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-填补缺失值"><span class="nav-number">5.4.</span> <span class="nav-text">4.填补缺失值</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据可视化——基础绘图体系"><span class="nav-number">6.</span> <span class="nav-text">数据可视化——基础绘图体系</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-图形设备"><span class="nav-number">6.1.</span> <span class="nav-text">1.图形设备</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-数值型单变量的可视化（箱线图和直方图）"><span class="nav-number">6.2.</span> <span class="nav-text">2.数值型单变量的可视化（箱线图和直方图）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-数值型单变量的可视化（密度图和小提琴图）"><span class="nav-number">6.3.</span> <span class="nav-text">3.数值型单变量的可视化（密度图和小提琴图）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数据可视化——多变量关系可视化"><span class="nav-number">7.</span> <span class="nav-text">数据可视化——多变量关系可视化</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-双变量的可视化"><span class="nav-number">7.1.</span> <span class="nav-text">1.双变量的可视化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-多变量的可视化"><span class="nav-number">7.2.</span> <span class="nav-text">2.多变量的可视化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-分组可视化"><span class="nav-number">7.3.</span> <span class="nav-text">3.分组可视化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-自定义面板函数实例"><span class="nav-number">7.4.</span> <span class="nav-text">4.自定义面板函数实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#假设检验"><span class="nav-number">8.</span> <span class="nav-text">假设检验</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-假设检验概述"><span class="nav-number">8.1.</span> <span class="nav-text">1.假设检验概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-t分布和t检验"><span class="nav-number">8.2.</span> <span class="nav-text">2.t分布和t检验</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="rtk"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">rtk</p>
  <div class="site-description" itemprop="description">冷萃少冰不加糖</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/reitake" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;reitake" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/rrrrrtk" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;rrrrrtk" rel="noopener" target="_blank"><i class="fa fa-fw fa-instagram"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">rtk</span>
</div><span class="post-meta-item-icon">
    <i class="fa fa-clock-o"></i>
</span>
<span id="sitetime"></span>
<script language="javascript">
  function siteTime(){
    window.setTimeout("siteTime()", 1000);
    var seconds = 1000;
    var minutes = seconds * 60;
    var hours = minutes * 60;
    var days = hours * 24;
    var years = days * 365;
    var today = new Date();
    var todayYear = today.getFullYear();
    var todayMonth = today.getMonth()+1;
    var todayDate = today.getDate();
    var todayHour = today.getHours();
    var todayMinute = today.getMinutes();
    var todaySecond = today.getSeconds();
    /* Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
    year - 作为date对象的年份，为4位年份值
    month - 0-11之间的整数，做为date对象的月份
    day - 1-31之间的整数，做为date对象的天数
    hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
    minutes - 0-59之间的整数，做为date对象的分钟数
    seconds - 0-59之间的整数，做为date对象的秒数
    microseconds - 0-999之间的整数，做为date对象的毫秒数 */
    var t1 = Date.UTC(2019,03,07,10,00,00); //建站时间
    var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
    var diff = t2-t1;
    var diffYears = Math.floor(diff/years);
    var diffDays = Math.floor((diff/days)-diffYears*365);
    var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
    var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
    var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
    document.getElementById("sitetime").innerHTML=" 已运行"+diffYears+" 年 "+diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒 ~喵~";
  }/*因为建站时间还没有一年，就将之注释掉了。需要的可以取消*/
  siteTime();
</script>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'FY0k4GNyVIFSqBrIxPq7yN7t-gzGzoHsz',
      appKey     : 'FqCFfTcVczkkBx9SyMlf7myz',
      placeholder: "喵w ヾﾉ≧w≦)o",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
